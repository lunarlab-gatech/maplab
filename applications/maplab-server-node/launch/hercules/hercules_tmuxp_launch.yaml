session_name: maplab_server_hercules

environment:
  DATASET_NUM: V2.3.C

options:
  default-command: /bin/bash

windows:
- window_name: main
  layout: tiled
  focus: true
  shell_command_before:
  - source /opt/ros/noetic/setup.bash
  - source /home/$(id -un)/maplab_ws/devel/setup.bash
  panes:
  - shell_command:
    - roscore
  - shell_command:
    - sleep 3
    - roslaunch maplab_server_node hercules-maplab-server-base-station.launch dataset_number:=${DATASET_NUM}
  - shell_command:
    - sleep 2
    - mkdir -p /home/$(id -un)/data/Hercules_datasets/${DATASET_NUM}/results/maplab_results/rovioli/Husky1/
    - mkdir -p /home/$(id -un)/data/Hercules_datasets/${DATASET_NUM}/results/maplab_results/rovioli/Husky2/
    - mkdir -p /home/$(id -un)/data/Hercules_datasets/${DATASET_NUM}/results/maplab_results/rovioli/Drone1/
    - mkdir -p /home/$(id -un)/data/Hercules_datasets/${DATASET_NUM}/results/maplab_results/rovioli/Drone2/
    - roslaunch maplab_server_node hercules-maplab-server-robots.launch dataset_number:=${DATASET_NUM}
  - shell_command:
    - rviz -d /home/$(id -un)/maplab_ws/src/maplab/applications/maplab-server-node/launch/hercules/ros/hercules-maplab-server-Drone1.rviz
  - shell_command:
    - sleep 4
    - source /opt/miniconda3/bin/activate robotdataprocess
    - python /home/nisemono/maplab_ws/src/maplab/dependencies/3rdparty/robotdataprocess/examples/Hercules/publish/publish_data_Maplab.py --dataset_num ${DATASET_NUM} --robot_name Drone1
  # - shell_command:
  #   - sleep 4
  #   - source /opt/miniconda3/bin/activate robotdataprocess
  #   - python /home/nisemono/maplab_ws/src/maplab/dependencies/3rdparty/robotdataprocess/examples/Hercules/publish/publish_data_Maplab.py --dataset_num ${DATASET_NUM} --robot_name Drone2
  # - shell_command:
  #   - sleep 4
  #   - rosrun tf2_ros static_transform_publisher 0 0 0 0 0 0 map mission

- window_name: kill
  layout: tiled
  shell_command_before:
  - source /opt/ros/noetic/setup.bash
  - source /home/$(id -un)/maplab_ws/devel/setup.bash
  panes:
  - tmux kill-session -t maplab_server_hercules_